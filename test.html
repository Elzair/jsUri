<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    <title>juribuilder tests</title>
    <script type="text/javascript" src="juribuilder.js"></script>
    <script type="text/javascript" src="jsunit/app/jsUnitCore.js"></script>
    <script type="text/javascript">

        // simple Uri formatting tests
        function _testSimpleUri(s) {
            var uri = new juribuilder(s);
            assertEquals('Testing that the stringified object matches the original URI', s, uri.toString());
        }

        function testSimpleRelativeUri() { _testSimpleUri('/'); }
        function testSimpleRelativeDirectoryUri() { _testSimpleUri('tutorial1/'); }
        function testSimpleRelativeDirectory2Uri() { _testSimpleUri('/experts/'); }
        function testSimpleRelativeWithFilenameUri() { _testSimpleUri('/index.html'); }
        function testSimpleRelativeWithDirectoryAndFilenameUri() { _testSimpleUri('tutorial1/2.html'); }
        function testSimpleRelativeParentDirectoryUri() { _testSimpleUri('../'); }
        function testSimpleRelativeSiblingDirectoryUri() { _testSimpleUri('../experts/'); }
        function testSimpleRelativeGreatGrandparentDirectoryUri() { _testSimpleUri('../../../'); }
        function testSimpleRelativeCurrentDirectoryUri() { _testSimpleUri('./'); }
        function testSimpleRelativeCurrentDirectorySiblingDocUri() { _testSimpleUri('./test.html'); }
        function testSimpleAbsoluteUri() { _testSimpleUri('http://www.test.com/index.html'); }
        function testSimpleHttpsUri() { _testSimpleUri('http://www.test.com/index.html'); }
        function testSimpleCustomPortUri() { _testSimpleUri('http://www.test.com:8080/index.html'); }
        function testSimpleHttpsCustomPortUri() { _testSimpleUri('https://www.test.com:43443'); }
        function testSimpleRelativeWithAnchorUri() { _testSimpleUri('/index.html#content'); }
        function testSimpleAbsoluteWithAnchorUri() { _testSimpleUri('http://www.test.com/index.html#content'); }
        function testSimpleRelativeWithParamsUri() { _testSimpleUri('/index.html?a=1&b=2'); }
        function testSimpleAbsoluteWithParamsUri() { _testSimpleUri('http://www.test.com/index.html?a=1&b=2'); }
        function testSimpleAbsoluteWithParamsAndAnchorUri() { _testSimpleUri('http://www.test.com/index.html?a=1&b=2#content'); }
        function testSimpleWithMultipleParamValuesUri() { _testSimpleUri('http://www.test.com/index.html?arr=1&arr=2&arr=3&arr=3&b=2'); }
        function testSimpleWithBlankParamValuesUri() { _testSimpleUri('http://www.test.com/index.html?arr=1&arr=&arr=2'); }
        function testSimpleWithoutSchemeUri() { _testSimpleUri('//www.test.com/'); }

        // Uri manipulation tests
        function testReplacingProtocol() {
            var u = new juribuilder('http://www.test.com/index.html?arr=1&arr=&arr=2');
            u.protocol = 'https';
            assertEquals('There should be a single colon', u.toString(), 'https://www.test.com/index.html?arr=1&arr=&arr=2');
        }

        function testReplacingProtocolWithColon() {
            var u = new juribuilder('http://www.test.com/index.html?arr=1&arr=&arr=2');
            u.protocol = 'https:';
            assertEquals('There should not be a double colon', u.toString(), 'https://www.test.com/index.html?arr=1&arr=&arr=2');
        }

        function testReplacingProtocolWithColon() {
            var u = new juribuilder('http://www.test.com/index.html?arr=1&arr=&arr=2');
            u.protocol = 'https:';
            assertEquals('There should not be a double colon', u.toString(), 'https://www.test.com/index.html?arr=1&arr=&arr=2');
        }

        function testDisablingHasAuthorityPrefix() {
            var u = new juribuilder('//test.com/index.html');
            u.hasAuthorityPrefix = false;
            assertEquals('There should be no leading slashes', u.toString(), 'test.com/index.html');
        }

        function testDisablingProtocolAndHasAuthorityPrefix() {
            var u = new juribuilder('https://test.com/index.html');
            u.protocol = null;
            u.hasAuthorityPrefix = false;
            assertEquals('There should be no leading slashes', u.toString(), 'test.com/index.html');
        }

        function testDisablingHasAuthorityPrefixWithProtocolError() {
            var u = new juribuilder('http://www.test.com/');
            try {
                u.hasAuthorityPrefix = false;
            } 
            catch (e) {
                return;
            }
            fail('Disabling authority prefix when there is still a protocol value should have throw an exception.');   
        }

        function testAddingUserInfo() {
            var u = new juribuilder('https://test.com/index.html');
            u.userInfo = 'username:password';
            assertEquals('The dummy login information should be included in the url', u.toString(), 'https://username:password@test.com/index.html');
        }

        function testAddingUserInfoWithTrailing() {
            var u = new juribuilder('https://test.com/index.html');
            u.userInfo = 'username:password@';
            assertEquals('The superfluous trailing symbol should be stripped', u.toString(), 'https://username:password@test.com/index.html');
        }

        // query string manipulation tests

        // path manipulation tests

    </script>
</head>
<body>
    <p>
        <a href="jsunit/testRunner.html?testPage=" id="testLink">Click here</a> to launch the JsUnit Test Runner.
    </p>
    <script type="text/javascript">
        var testLink = document.getElementById('testLink');
        testLink.href = testLink.href + window.location;
    </script>
</body>
</html>